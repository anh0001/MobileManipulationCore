# Robot-specific parameters for mobile manipulator
# Customize these values for your specific robot configuration

robot:
  # TF frame identifiers
  frames:
    map: "map"
    odom: "odom"
    base_link: "base_link"
    base_footprint: "base_footprint"
    camera_link: "piper_camera_link"
    camera_optical: "piper_camera_optical_frame"
    ee_link: "piper_link6"
    arm_base: "piper_base_link"

  # Topic names (customize if your robot uses different topics)
  topics:
    camera_rgb: "/piper/wrist_camera/piper_d405/color/image_rect_raw"
    camera_depth: "/piper/wrist_camera/piper_d405/depth/image_rect_raw"
    camera_info: "/piper/wrist_camera/piper_d405/color/camera_info"
    joint_states: "/joint_states"
    cmd_vel: "/cmd_vel"
    odom: "/odom"
    scan: "/scan"

  # Action servers
  actions:
    navigate_to_pose: "/navigate_to_pose"
    follow_joint_trajectory: "/piper_arm_controller/follow_joint_trajectory"
    gripper_follow_joint_trajectory: "/piper_gripper_controller/follow_joint_trajectory"

bridge_v2_virtual_frames:
  enabled: true
  # Keep this on piper_camera_link to emulate Bridge-V2 camera conditioning from wrist camera data.
  parent_camera_frame: "piper_camera_link"
  camera_virtual_frame: "bridge_v2_camera_virtual"
  base_virtual_frame: "bridge_v2_base_virtual"
  # Bridge V2 nominal camera pose expressed in Bridge base frame.
  # When enabled, launch inverts this pose and publishes:
  # bridge_v2_camera_virtual -> bridge_v2_base_virtual
  camera_in_bridge_base:
    x: -0.18
    y: 0.0
    z: 0.50
    roll: 0.0
    pitch: -0.78539816339
    yaw: 0.0

# Base (mobile platform) parameters
base:
  max_linear_velocity: 0.5  # m/s
  max_angular_velocity: 1.0  # rad/s
  max_linear_acceleration: 0.3  # m/s^2
  max_angular_acceleration: 1.5  # rad/s^2
  safety_distance: 0.2  # m (minimum distance to obstacles)

# Arm (manipulator) parameters
arm:
  num_joints: 6
  joint_names:
    - "piper_joint1"
    - "piper_joint2"
    - "piper_joint3"
    - "piper_joint4"
    - "piper_joint5"
    - "piper_joint6"
  command_duration_sec: 1.5

  # Joint limits (radians)
  joint_limits:
    lower: [-3.14, -1.57, -1.57, -3.14, -1.57, -3.14]
    upper: [3.14, 1.57, 1.57, 3.14, 1.57, 3.14]

  max_joint_velocity: 1.0  # rad/s
  max_joint_acceleration: 2.0  # rad/s^2

# Gripper parameters
gripper:
  has_gripper: true
  type: "parallel"  # parallel, suction, etc.
  max_width: 0.08  # meters
  min_width: 0.0   # meters
  max_effort: 50.0  # Newtons
  joint_name: "piper_joint7"
  joint_names:
    - "piper_joint7"
  open_position: 0.075
  closed_position: 0.0
  open_positions: [0.075]
  closed_positions: [0.0]
  command_duration_sec: 0.75
  command_epsilon: 0.01

# MoveIt parameters for the PiPER arm
moveit:
  enabled: true
  arm_execution_mode: "moveit_servo"  # Options: moveit_servo, move_group
  move_group_action: "/move_action"
  move_group_name: "piper_arm"
  eef_link: "piper_link6"
  action_wait_sec: 1.0
  planning_time: 2.0
  planning_attempts: 3
  velocity_scaling: 0.5
  accel_scaling: 0.5
  position_tolerance: 0.01
  orientation_tolerance: 0.1
  servo_cartesian_topic: "/servo_node/delta_twist_cmds"
  servo_publish_rate_hz: 30.0
  servo_command_horizon_sec: 0.0  # <=0 derives from policy inference rate
  servo_max_linear_velocity: 0.10
  servo_max_angular_velocity: 0.35
  pause_base_during_servo: true
  servo_start_service: "/servo_node/start_servo"

# Workspace limits for end-effector reachability check
workspace:
  frame_id: piper_base_link
  x_min: -0.1
  x_max: 0.9
  y_min: -0.6
  y_max: 0.6
  z_min: -0.2
  z_max: 1.0
